"use strict";(()=>{var e={};e.id=947,e.ids=[947],e.modules={2651:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.d(t,{G6:()=>m,Hh:()=>p,Jv:()=>l,hu:()=>d,zR:()=>c});var r=a(4337),i=a(6168),n=a(5486),o=a.n(n),u=e([r,i]);[r,i]=u.then?(await u)():u;let g=(0,r.getFirestore)(i.A);async function c(e){return(await (0,r.getDocs)((0,r.collection)(g,e))).docs.map(e=>({id:e.id,...e.data()}))}async function d(e,t){return(await (0,r.getDoc)((0,r.doc)(g,e,t))).data()}async function l({email:e,password:t}){if(""===e||""===t)return null;let a=(0,r.query)((0,r.collection)(g,"users"),(0,r.where)("email","==",e),(0,r.where)("type","==","credential"));return(await (0,r.getDocs)(a)).docs.map(e=>({id:e.id,email:e.data().email,fullname:e.data().fullname,password:e.data().password,image:e.data().image||"",type:e.data().type||"",role:e.data().role}))[0]||null}async function p(e,t){if(""===e.fullname){t({status:!1,message:"Fullname is Required!"});return}if(""===e.email){t({status:!1,message:"Email is Required!"});return}if(""===e.password){t({status:!1,message:"Password is Required!"});return}let a=(0,r.query)((0,r.collection)(g,"users"),(0,r.where)("email","==",e.email));(await (0,r.getDocs)(a)).docs.map(e=>({id:e.id,...e.data()})).length>0?t({status:!1,message:"Email Already Exists"}):(e.password=await o().hash(e.password,10),e.type="credential",e.role="member",await (0,r.addDoc)((0,r.collection)(g,"users"),e).then(()=>{t({status:!0,message:"Register Success"})}).catch(e=>{t({status:!1,message:e})}))}async function m(e,t){let a=(0,r.query)((0,r.collection)(g,"users"),(0,r.where)("email","==",e.email)),s=(await (0,r.getDocs)(a)).docs.map(e=>({id:e.id,...e.data()}));s.length>0?(e.role=s[0].role,await (0,r.updateDoc)((0,r.doc)(g,"users",s[0].id),e).then(()=>{t({status:!0,message:"Sign In with Google Success!",data:e})}).catch(()=>{t({status:!1,message:"Sign In with Google Failed!"})})):(e.role="member",await (0,r.addDoc)((0,r.collection)(g,"users"),e).then(()=>{t({status:!0,message:"Sign In with Google Success!",data:e})}).catch(()=>{t({status:!1,message:"Sign In with Google Failed!"})}))}s()}catch(e){s(e)}})},3480:(e,t,a)=>{e.exports=a(5600)},4337:e=>{e.exports=import("firebase/firestore")},4558:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.r(t),a.d(t,{default:()=>n});var r=a(2651),i=e([r]);async function n(e,t){if(e.query.products?.[1]){let a=await (0,r.hu)("products",e.query.products[1]);a?t.status(200).json({status:!0,statusCode:200,data:a}):t.status(400).json({status:!1,statusCode:400,errors:["nggk ada datanya"]})}else{let e=await (0,r.zR)("products");e?t.status(200).json({status:!0,statusCode:200,data:e}):t.status(400).json({status:!1,statusCode:400,errors:["nggk ada datanya"]})}}r=(i.then?(await i)():i)[0],s()}catch(e){s(e)}})},5486:e=>{e.exports=require("bcrypt")},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6168:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.d(t,{A:()=>o});var r=a(6551),i=e([r]);r=(i.then?(await i)():i)[0];let n={apiKey:process.env.FIREBASE_API_KEY,authDomain:process.env.FIREBASE_AUTH_DOMAIN,projectId:process.env.FIREBASE_PROJECT_ID,storageBucket:process.env.FIREBASE_STORAGE_BUCKET,messagingSenderId:process.env.FIREBASE_MESSAGING_SENDER_ID,appId:process.env.FIREBASE_APP_ID},o=(0,r.initializeApp)(n);s()}catch(e){s(e)}})},6392:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.r(t),a.d(t,{config:()=>d,default:()=>c,routeModule:()=>l});var r=a(3480),i=a(8667),n=a(6435),o=a(4558),u=e([o]);o=(u.then?(await u)():u)[0];let c=(0,n.M)(o,"default"),d=(0,n.M)(o,"config"),l=new r.PagesAPIRouteModule({definition:{kind:i.A.PAGES_API,page:"/api/[[...products]]",pathname:"/api/[[...products]]",bundlePath:"",filename:""},userland:o});s()}catch(e){s(e)}})},6435:(e,t)=>{Object.defineProperty(t,"M",{enumerable:!0,get:function(){return function e(t,a){return a in t?t[a]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,a)):"function"==typeof t&&"default"===a?t:void 0}}})},6551:e=>{e.exports=import("firebase/app")},8667:(e,t)=>{Object.defineProperty(t,"A",{enumerable:!0,get:function(){return a}});var a=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})}};var t=require("../../webpack-api-runtime.js");t.C(e);var a=t(t.s=6392);module.exports=a})();